// Generated by CoffeeScript 1.10.0
(function(window, $, templates) {
  var errorMessage, errorMessageId, form, initPlugin, removeMessage, section, submitData, successMessage, successMessageId, url;
  section = $('#dashboard-ftp');
  successMessageId = '#ftpSettingsSaveOK';
  errorMessageId = '#ftpSettingsSaveError';
  successMessage = null;
  errorMessage = null;
  form = null;
  url = null;
  removeMessage = function() {
    return (form.find('.o-form-message')).slideUp(function() {
      return ($(this)).remove();
    });
  };
  submitData = function(data) {
    var res;
    res = $.post(url, data);
    res.done(function(data) {
      form.append(successMessage);
      section.trigger('remax');
      return setTimeout(removeMessage, 3000);
    });
    return res.fail(function() {
      form.append(errorMessage);
      return section.trigger('remax');
    });
  };
  initPlugin = function() {
    $(successMessageId).loadTemplate();
    $(errorMessageId).loadTemplate();
    successMessage = templates.ftpSettingsSaveOK;
    errorMessage = templates.ftpSettingsSaveError;
    form = section.find('#ftp-settings-form');
    url = form.attr('action');
    return form.on('submit', function(e) {
      var data;
      e.preventDefault();
      data = form.serialize();
      return submitData(data);
    });
  };
  return section.on('dashboard-plugin-loaded', initPlugin);
})(this, this.jQuery, this.templates);
